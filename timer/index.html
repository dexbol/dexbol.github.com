<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
        <title>Timer</title>
        <link
            href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap"
            rel="stylesheet"
        />
        <style type="text/css">
            html,
            body {
                margin: 0;
                padding: 0;
                font-family: 'Orbitron';
                color: #333;
            }
            .container {
                width: 40vw;
                margin: 4vw auto 0;
            }
            .digital {
                font-size: 10vw;
                text-align: center;
            }
            button {
                display: block;
                width: 18vw;
                height: 4vw;
                margin: 4vw auto 0;
                font-size: 2vw;
                text-transform: uppercase;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="digital"></div>
            <div class="panel">
                <button>Start</button>
            </div>
        </div>
        <script type="text/javascript">
            var digitalNode = document.querySelector('.digital');
            var seconds = 0;
            var timer = null;

            function format(s) {
                var minutes = Math.floor(s / 60);
                var sec = s % 60;

                return (
                    (minutes < 10 ? '0' + minutes : minutes) +
                    ':' +
                    (sec < 10 ? '0' + sec : sec)
                );
            }

            function start() {
                seconds = 25 * 60;
                clearTimeout(timer);
                timer = setTimeout(count, 1000);
            }

            function count() {
                seconds--;
                digitalNode.innerHTML = format(Math.abs(seconds));
                digitalNode.style.color = seconds >= 0 ? '#333' : '#999';
                timer = setTimeout(count, 1000);

                if (seconds == 0) {
                    new Notification('Time Out', {
                        icon: './tomato.png'
                    });
                }
            }

            document
                .querySelector('button')
                .addEventListener('click', function (event) {
                    Notification.requestPermission().then(start, function (
                        err
                    ) {
                        alert(err.toString());
                    });
                });

            digitalNode.innerHTML = format(seconds);
        </script>
    </body>
</html>
